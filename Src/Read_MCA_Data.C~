#include "Read_MCA_Data.h"

ClassImp(Read_MCA_Data);

//////////

Read_MCA_Data::Read_MCA_Data(const TString& data_file, const TString& histo_name, const TString& histo_title) : histo(histo_name, histo_title, 8192, 0, 8192)
{
  fin.open(data_file);
  if(fin.is_open()==kFALSE)
    {
      cout << "Can not find data file! " << data_file << endl;
      exit(1);
    }
  
  Fill_Histo();
}//Read_MCA_Data::Read_MCA_Data()

//////////

Read_MCA_Data::~Read_MCA_Data()
{
  fin.close();
}//Read_MCA_Data::~Read_MCA_Data()

//////////

void Read_MCA_Data::Fill_Histo()
{
  Bool_t chk_head = kFALSE;
  Int_t ibin = 0;
  
  while(!fin.eof())
    {
      string buf;

      getline(fin, buf);
      if(buf.compare("")==0) break;

      TString tbuf = buf;
      if(tbuf.Contains("<<DATA>>")==kTRUE && chk_head==kFALSE) chk_head = kTRUE; 
      else if(tbuf.Contains("<<END>>")==kTRUE && chk_head==kTRUE) break;
      else if(chk_head==kTRUE)
	{
	  ibin++;
	  Int_t content = tbuf.Atoi();
	  histo.SetBinContent(ibin, content);
	}
    }
  
  return;
}//void Read_MCA_Data::Fill_Histo()

//////////
